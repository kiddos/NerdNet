set(OPENCV_LIBS opencv_core opencv_highgui opencv_imgproc opencv_imgcodecs)
set(MATHGL_LIBS mgl mgl-qt)
set(REQUIRED_LIBS ${OPENCV_LIBS} ${MATHGL_LIBS})

find_library(HAVE_LIBS NAMES ${REQUIRED_LIBS})

if(HAVE_LIBS)
  message("-- found required libraries for building tests")
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -O3 -g -std=c++11 -DDEBUG -fopenmp")

  include_directories(${CMAKE_SOURCE_DIR}/src)
  link_directories(/usr/lib ${CMAKE_BINARY_DIR}/src)

  add_executable(ModelTest model_test.cpp)
  add_executable(XORProblem test1.cpp)
  add_executable(MNIST test2.cpp)
  add_executable(Softmaxtest test9.cpp)
  add_executable(Crossentropytest test18.cpp)
  add_executable(Softmaxtest2 test19.cpp)
  add_executable(Quadratictest test20.cpp)
  add_executable(Kullbackleiblertest test21.cpp)
  add_executable(Gametest test22.cpp)
  add_executable(Drawimagetest test23.cpp)
  add_executable(SpiralDataTest spiraldata_test.cpp)
  add_executable(MomentumTest test25.cpp)
  add_executable(nursery test17.cpp)

  add_executable(ConvLayerTest convlayer_test.cpp)

  set(OPENCV_LIBS opencv_core opencv_highgui opencv_imgproc opencv_imgcodecs)
  set(MATHGL_LIBS mgl mgl-qt)
  set(LIBS nnet armadillo ${OPENCV_LIBS} ${MATHGL_LIBS})

  target_link_libraries(ModelTest ${LIBS})
  target_link_libraries(XORProblem ${LIBS})
  target_link_libraries(MNIST ${LIBS})
  target_link_libraries(Softmaxtest ${LIBS})
  target_link_libraries(Crossentropytest ${LIBS})
  target_link_libraries(Softmaxtest2 ${LIBS})
  target_link_libraries(Quadratictest ${LIBS})
  target_link_libraries(Kullbackleiblertest ${LIBS})
  target_link_libraries(Gametest ${LIBS})
  target_link_libraries(Drawimagetest ${LIBS})
  target_link_libraries(SpiralDataTest ${LIBS})
  target_link_libraries(MomentumTest ${LIBS})
  target_link_libraries(ConvLayerTest ${LIBS})
  target_link_libraries(nursery ${LIBS})

  add_test(ModelTest ${LIBS})
  add_test(XORProblem ./XORProblem)
  add_test(MNIST ./MNIST)
  add_test(softmaxtest ./softmaxtest)
  add_test(crossentropytest ./crossentropytest)
  add_test(softmaxtest2 ./softmaxtest2)
  add_test(quadratictest ./quadratictest)
  add_test(kullbackleiblertest ./kullbackleiblertest)
endif(HAVE_LIBS)

